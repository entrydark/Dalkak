!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.dalkak=n()}(this,function(){var t=function t(n){this.name=n||t.randomize()};t.randomize=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",o=0;o<5;o++)n+=t.charAt(Math.floor(Math.random()*t.length));return n};var n=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];this.poses=t||[],this.dimension=this.poses.length};n.prototype.rotate=function(t){void 0===t&&(t=0),t=t*Math.PI/180},n.prototype.round=function(t){return void 0===t&&(t=0),new(Function.prototype.bind.apply(n,[null].concat(this.poses.map(function(n){return Math.round(n*Math.pow(10,t))/Math.pow(10,t)}))))};var o=function(n,o,e,i){this.name=n||t.randomize(),this.template=o||"",this.params=this.genParams(/<<(?<boolean>.+?)>>|\(\((?<string>.+?)\)\)|{{(?<block>.+?)}}/g),this.func=e||new Function};o.prototype.genParams=function(t){var n={};return(this.template.match(t)||[]).forEach(function(o){t.lastIndex=0;var e=t.exec(o).groups;e.boolean?n[e.boolean]=new i("boolean",e.boolean):e.string?n[e.string]=new i("string",e.string):e.block&&(n[e.block]=new i("block",e.block))}),n};var e=function(t,n){this.parent=t||new o,this.setParams(n||[])};e.prototype.setParams=function(t){return this.params=Object.assign(this.parent.params,t),this},e.from=function(t){return new e(t)};var i=function(n,o){this.type=n,this.name=o||t.randomize(),this.value="boolean"==this.type&&Boolean()||"string"==this.type&&String()||"block"==this.type&&new e},r=function(n,o){this.name=n||t.randomize(),this.blockGroups=[]};r.prototype.link=function(t){return this.blockGroups.push(t),this},r.prototype.fire=function(t){for(var n in this.blockGroups)this.blockGroups[n].start(t);return this};var s=function(t,n){this.event=t||new r,this.blocks=n||[]};s.prototype.ready=function(){return this.event.link(this),this},s.prototype.start=function(t){for(var n in this.blocks)this.blocks[n].parent.func();return this},s.prototype.attach=function(t){return new s(this.event,this.blocks.concat(t.blocks))},s.from=function(t){return new s(void 0,[t])};var a=function(o,e,i){this.name=o||t.randomize(),this.pos=e||new n,this.blocks=i||[]};a.prototype.addBlock=function(t){return this.blocks.push(t),this},a.prototype.ready=function(){this.blocks.forEach(function(t){return t.ready()})};var c=function(t){function n(n,o,e,i){t.call(this,n,o,e),this.children=i||[]}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.addThing=function(t){return this.children.push(t),this},n.prototype.ready=function(){this.children.forEach(function(t){return t.ready()})},n}(a),h=function(n,o,e){this.name=n||t.randomize(),this.things=o||new c("Global"),this.blockSets=e||[]};return h.prototype.addThing=function(t){return this.things.addThing(t),this},h.prototype.ready=function(){this.things.ready()},{Name:t,Vector:n,Param:i,Event:r,BlockInfo:o,BlockSet:function(t,n,o){this.infos=n||[],this.events=o||[]},Block:e,BlockGroup:s,Thing:a,ThingGroup:c,Project:h}});
